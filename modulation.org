# -*- eval: (setq org-download-image-dir (file-name-sans-extension (buffer-name))); -*-
# -*- org-export-babel-evaluate: nil; -*-
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="../orgstyle.css"/>
#+OPTIONS: ':nil *:t -:t ::t <:t H:3 \n:t arch:headline author:t c:nil S:nil -:nil
#+OPTIONS: creator:nil d:(not "En") date:t e:t email:nil f:t inline:t
#+OPTIONS: num:t p:nil pri:nil prop:nil stat:t tags:t tasks:t tex:t timestamp:t
#+OPTIONS: title:t toc:t todo:t |:t 
#+OPTIONS: ^:{}
#+LATEX_CLASS: ctexart
#+STARTUP: entitiespretty:t
#+TITLE: 信号调制
#+SELECT_TAGS: export
#+EXCLUDE_TAGS: noexport
#+CREATOR: Emacs 26.0.50.2 (Org mode 9.0.4)

* 信号调制
#+BEGIN_SRC dot :file Images/mod_class.png :results file
digraph G {
m [label="模拟调制"];
s [label="数字调制"];

m->{AM,FM,PM};
          }
#+END_SRC

#+RESULTS:
[[file:Images/mod_class.png]]

** AM
   载波信号为 $c(t)=\cos(2\pi f_ct+\theta_c)$ , $f_c$ 为载波频率，$\theta_c$ 为载波起始相位。为方便讨论，假设 $\theta_c=0$ .

   调制信号的波形为 $x(t)$ ,调制时，外加直流分量 $A_0$ ,输出已调信号的包络正比于 $x(t)$ ,其时域波形为：
   \begin{equation}
   s_{AM}(t)=[A_0+x(t)]\cos2\pi f_ct
   \end{equation}
   通常将 $S_{AM}(t)$ 写成
   \begin{equation}\label{eq-sAMt}
   s_{AM}(t)=[1+mx(t)]\cos2\pi f_ct
   \end{equation}
   其中， $m$ 为调制深度，使用包络检波等方法能恢复出原始信号，但为了保证不失真，必须满足 $1+mx(t)\geq 0$ .
   已知信号 $x(t)$ 的频谱为 $X(f)$ ,则已调制信号的频谱为
   \begin{equation}
   S_{AM}(f)=\frac{1}{2}[\delta(f-f_c)+\delta(f+f_c)]+\frac{m}{2}[X(f-f_c)+X(f+f_c)]
   \end{equation}

   式 ref:eq-sAMt 可以重写为
   \begin{equation}
   s_{AM}(t)=\Re{[1+mx(t)]\exp(j2\pi f_ct)]
   \end{equation}

   可知，已调信号的瞬时幅度是 $|1+mx(t)|$ , 瞬时相位是 $2\pi f_c t$ 。
   *瞬时幅度是时变函数，去除载波线性相位后的瞬时相位是常数。*


** FM
如果调制后*信号的幅度不变*，而瞬时频率是调制信号的线性函数，这样的调制方式称为频率调制。

调频信号的时域表达式为：
\begin{equation}\label{eq-sFMt}
s_{FM}(t)=A\cos[2\pi f_ct+2\pi k_f\int_{-\infty}^{t}x(\tau)d\tau]
\end{equation}
假设复信号 $\exp(j2\pi k_f\int_{-\infty}^{t}x(\tau)d\tau)$ 的频谱为 $G(f)$ ,则

\begin{equation}
S_{FM}(f)=A\frac{1}{2}[G(f-f_c)+G(f+f_c)]
\end{equation}

下面对FM信号进行频谱分析[fn:1], 假设调制信号是一个简单的正弦信号，频率为 $f_m$ 即，$x(t)=A_m\cos2\pi f_mt$
式 ref:eq-sFMt 的瞬时相位为：
\begin{equation}
\Phi(t)=2\pi f_ct+2\pi k_f\int_{-\infty}^{t}x(\tau)d\tau
\end{equation}

则瞬时频率为
\begin{align}
\frac{1}{2\pi}\frac{d\Phi(t)}{dt}=&f_c+k_fx(t)\\\notag
=&f_c+k_fA_m\cos2\pi f_mt
\end{align}
上式说明瞬时频率在 $f_c$ 附近上下变化，变化幅度为 $k_fA_m$ ―信号的频偏峰值，记为 $\Delta f=k_fA_m$.
上式两边积分，又可得出（假定零时刻相位为零）：
\begin{equation}
\Phi(t)=2\pi f_ct+\frac{\Delta f}{f_m}\sin2\pi f_mt
\end{equation}
定义调制指数（或调频指数） $\beta=\frac{\Delta f}{f_m}$ 因此，ref:eq-sFMt 可以写成
\begin{equation}
s_{FM}(t)=A\cos[2\pi f_ct+\beta\sin(2\pi f_mt)]
\end{equation}

经过复杂的推导[fn:2]，上式可以写成：
\begin{equation}
\cos[2\pi f_ct+\beta\sin(2\pi f_mt)]=\sum_{-\infty}^{\infty}J_{n}(\beta)\cos(2\pi(f_c+nf_m)t)
\end{equation}

其中， $J_n(\beta)$ 为第一类贝塞尔函数[fn:3][fn:4]。理论上，无论是发射还是接收FM信号都需要无限大的带宽，但是当 $\beta$ 取值较小时，贝塞尔函数迅速衰减；当 $\beta$ 取值较大时，贝塞尔函数会出现先增大后减小的变化趋势。
在许多实际情况下，调频系数较小， $\beta$ 都满足小于1的条件，这被称为窄带调频信号。
\begin{equation}
s_{FM}(t)\approx AJ_0(\beta)\cos(2\pi f_ct) + AJ_1(\beta)[\cos(2\pi(f_c+f_m)t)-\cos(2\pi(f_c-f_m)t)]
\end{equation}

#+BEGIN_SRC python :session report :exports results :results file
from __future__ import division
import numpy as np
import matplotlib.pyplot as plt

beta=1
fm=1000

A=1
fc=20000
fs=67000
dt=1/fs

N=2048
t=np.array(range(N))*dt
faxis=np.linspace(0,fs,N)
sig=A*np.cos(2*np.pi*fc*t+beta*np.sin(2*np.pi*fm*t))

X=np.fft.fft(sig)
plt.close('all')
plt.plot(faxis,(np.abs(X)))
plt.axis('tight')
plt.savefig("FM_spec.png")
"FM_spec.png"
#+END_SRC

#+RESULTS:
[[file:FM_spec.png]]

* Footnotes


[fn:4] http://www2.ensc.sfu.ca/people/faculty/ho/ENSC327/Pre_10_Bessel.pdf

[fn:3] https://www.johndcook.com/blog/bessel_functions/

[fn:2] https://www.johndcook.com/blog/2016/02/17/analyzing-an-fm-signal/

[fn:1] https://www.st-andrews.ac.uk/~www_pa/Scots_Guide/RadCom/part12/page1.html





